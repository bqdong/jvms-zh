<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>原子类型 - JVM Specification (Java SE 17 Edition) Chinese Translation</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../introduction.html"><strong aria-hidden="true">1.</strong> 介绍</a></li><li class="chapter-item expanded "><a href="../chap02/structure_of_jvm.html"><strong aria-hidden="true">2.</strong> JVM的结构</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../chap02/class_file_format.html"><strong aria-hidden="true">2.1.</strong> class文件格式</a></li><li class="chapter-item expanded "><a href="../chap02/data_type.html"><strong aria-hidden="true">2.2.</strong> 数据类型</a></li><li class="chapter-item expanded "><a href="../chap02/primitive_type.html" class="active"><strong aria-hidden="true">2.3.</strong> 原子类型</a></li><li class="chapter-item expanded "><a href="../chap02/reference_type.html"><strong aria-hidden="true">2.4.</strong> 引用类型</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">JVM Specification (Java SE 17 Edition) Chinese Translation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h2 id="原子类型"><a class="header" href="#原子类型">原子类型</a></h2>
<p>Java 虚拟机支持的原子数据类型是数字类型（<em>numeric types</em>）、布尔类型(<code>boolean</code> type)（第 2.3.4 节）和 <code>returnAddress</code> 类型（第 2.3.3 节）。</p>
<p>数字类型由整数类型（<em>integral types</em>）（第 2.3.1 节）和浮点类型（<em>floating-point types</em>）组成（§2.3.2）。</p>
<p>整数类型包括：</p>
<ul>
<li><code>byte</code>，它的值时8位有符号二进制补码整数，默认值为0。</li>
<li><code>short</code>，它的值时16位有符号二进制补码整数，默认值为0。</li>
<li><code>int</code>，它的值时32位有符号二进制补码整数，默认值为0。</li>
<li><code>long</code>，它的值时64位有符号二进制补码整数，默认值为0。</li>
<li><code>char</code>，它的值时16位<strong>无符号</strong>整数表示的在<a href="https://zh.wikipedia.org/wiki/Unicode%E5%AD%97%E7%AC%A6%E5%B9%B3%E9%9D%A2%E6%98%A0%E5%B0%84#%E5%9F%BA%E6%9C%AC%E5%A4%9A%E6%96%87%E7%A7%8D%E5%B9%B3%E9%9D%A2">基本多文种平面</a>Unicode码点（code point），使用UTF-16编码，默认值是空码点（<code>\u0000</code>）。</li>
</ul>
<p>浮点类型包括：</p>
<ul>
<li><code>float</code>它的值与<a href="https://en.wikipedia.org/wiki/IEEE_754#Basic_and_interchange_formats">IEEE 754 binary32</a>格式的相对应，默认值是<strong>正数0</strong>（+0）</li>
<li><code>double</code>，它的值与<a href="https://en.wikipedia.org/wiki/IEEE_754#Basic_and_interchange_formats">IEEE 754 binary64</a>格式的相对应，默认值是<strong>正数0</strong>（+0）</li>
</ul>
<p><code>boolean</code>类型的值编码真值是<code>true</code>和<code>false</code>，默认值是<code>false</code>。</p>
<blockquote>
<p>第一版的<em>The Java Virtual Machine Specification</em>没有将<code>boolean</code>类型视为一种Java虚拟机类型。然而，<code>boolean</code>值在Java虚拟机中有受限的支持。第二版的<em>The Java Virtual Machine Specification</em>将<code>boolean</code>视为一种类型来阐明这个问题。</p>
</blockquote>
<p><code>returnAddress</code> 类型的值是指向 Java虚拟机指令的操作码的指针。 在原子类型中，只有 <code>returnAddress</code> 类型不是直接与 Java 编程语言类型相关联。</p>
<h3 id="整数类型和值"><a class="header" href="#整数类型和值">整数类型和值</a></h3>
<p>Java虚拟机的整数类型的值为：</p>
<ul>
<li>对于<code>byte</code>，范围为-128~127（\(-2^7\)~\(2^7-1\)），包含-128和127</li>
<li>对于<code>short</code>，范围为-32768~32767（\(-2^15\)~\(2^15-1\)），包含-32768和32767</li>
<li>对于<code>int</code>，范围为-2147483648 ~2147483647（\(-2^31\)~\(2^31-1\)），包含-2147483648和2147483647</li>
<li>对于<code>long</code>，范围为-9223372036854775808~9223372036854775807（\(-2^63\)~\(2^63-1\)），包含-9223372036854775808和9223372036854775807</li>
<li>对于<code>char</code>，范围为0~65535，包含0和65535</li>
</ul>
<h3 id="浮点类型和值"><a class="header" href="#浮点类型和值">浮点类型和值</a></h3>
<p>浮点类型有<code>float</code>和<code>double</code>，它们在概念上分别和IEEE 754 中的32位binary32和64位binary64浮点数格式的值和操作相关联(JLS§1.7)。</p>
<blockquote>
<p>在Java SE 15及之后的版本中，Java虚拟机使用IEEE 754的2019版标准。在Java SE 15之前，Java虚拟机使用的是1985版的IEEE  754标准，其中binary32格式被称为单精度（single format），binary64格式被称为双精度（double format）。</p>
</blockquote>
<p>IEEE 754不仅包括由符号和绝对值（<a href="https://simple.wikipedia.org/wiki/Magnitude_(mathematics)#:%7E:text=The%20magnitude%20of%20a%20real%20number%20is%20usually,absolute%20value%20or%20modulus.%20It%20is%20written%20as"><em>magnitude</em></a>）组成的正数和负数，还有正零和负零，正无穷大和负无穷大(<em>infinities</em>)，和特殊的非数值的值(Not-a-Number)(以下简称NaN)。NaN值为用于表示某些无效运算的结果，如0除以0。<code>float</code>和<code>double</code>类型的NaN常量被预定义为<code>Float.NaN</code>和<code>Double.NaN</code>。</p>
<p>有限的非零的浮点数类型的值可以被表示为\(s\cdot m \cdot 2^{(e-N+1)}\) ，这里的：</p>
<ul>
<li>\(s\) 是 +1 或者 -1，</li>
<li>\(m\) 是一个小于 \(2^N\) 的正整数，</li>
<li>\(e\) 是一个整数，满足\(E_{min}\le e \le E_{max}\) ，其中 \(E_{min}=-(2^{K-1}-2)\) ，\(E_{max}=2^{K-1}-1\) ，</li>
<li>\(N\) 和 \(K\) 是依赖于类型的参数</li>
</ul>
<p>有些值可以以多种方式表示为这种形式。例如，假设一个浮点类型的值 \(v\)可以用确定的\(s,m,e\) 表示成这种形式，恰好其中\(m\)是偶数，\(e\)小于\(2^{K-1}\)， 则可以产生该值的另一种表示方式：\(m\)减半，\(e\)增加1。</p>
<p>如果\(m \ge 2^{N-1}\)，这种形式的表示称为<em>normalized</em>；否则，被称为<em>subnormal</em>。如果一个浮点类型的值不能够以\(m \ge 2^{N-1}\)这种形式表示，则称该值为非规格数(<a href="https://en.wikipedia.org/wiki/Subnormal_number"><em>subnormal number</em></a>)，因为它的绝对值（magnitude）低于最小的规格数（normalized value）。(译者注：具体的术语参考<a href="https://en.wikipedia.org/wiki/IEEE_754">wiki</a>，这里翻译来自https://www.jianshu.com/p/43b1b09f27f4)</p>
<p><code>float</code>和<code>double</code>中\(N\) 和 \(K\) 参数的约束（以及有它们衍生的 \(E_{min}\) 和 \(E_{max}\)）总结在<a href="#floating-point-parameters">表2.3.2-A</a>中：</p>
<table width="60%" >
  <caption> <id id="floating-point-parameters">表2.3.2-A. 浮点数参数</id> </caption>
  <tr>
    <th>参数</th>
    <th><code>float</code></th>
    <th><code>double</code></th>
  </tr>
  <tr align="center">
    <td><math><mi>N</mi></math></td>
    <td>24</td>
    <td>53</td>
  </tr>
  <tr align="center">
    <td><math><mi>K</mi></math></td>
    <td>8</td>
    <td>11</td>
  </tr>
  <tr align="center">
    <td>
    <math>
      <msub>
        <mi>E</mi>
        <mrow>
          <mi>m</mi>
          <mi>a</mi>
          <mi>x</mi>
        </mrow>
      </msub>
    </math>
    </td>
    <td>+127</td>
    <td>+1023</td>
  </tr>
  <tr align="center">
    <td>
    <math>
      <msub>
        <mi>E</mi>
        <mrow>
          <mi>m</mi>
          <mi>i</mi>
          <mi>n</mi>
        </mrow>
      </msub>
    </math>
    </td>
    <td>-126</td>
    <td>-1022</td>
  </tr>
</table>
<p>除了NaN，浮点值是有序的（<em>ordered</em>）。从小到大进行排列，分别是负无穷，负有限非零值，正零和负零，正有限非零值，正无穷。</p>
<p>IEEE 754允许它的binary32和binary64浮点格式有多个不同格式的NaN。然而，Java SE平台通常将一个给定的浮点类型的NaN值看作为一个单一的规范值（a single canonical value），因此，该规范通常引用任意NaN，就像引用一个规范值。</p>
<blockquote>
<p>在IEEE 754下，用non-NaN参数进行浮点操作可能会产生NaN结果。IEEE 754指定了一组NaN位模式，但没有强制要求哪个特定的NaN位模式被用来表示NaN结果；这是留给了硬件体系结构。程序员可以创建具有不同位模式的NaN编码，例如，回溯性诊断信息（<em>A programmer can create NaNs with different bit patterns to
encode, for example, retrospective diagnostic information.</em>）。这些NaN值可以是使用<code>Float.intBitsToFloat</code>和<code>Double.longBitsToDouble</code>创建，<code>float</code>对应<code>Float.intBitsToFloat</code>，<code>double</code>对应<code>Double.longBitsToDouble</code>。相反，要检查NaN值的位模式，<code>float</code>和<code>double</code>类型可以分别使用<code>Float.floatToRawIntBits</code>和<code>Double.doubleToRawLongBits</code>方法。</p>
</blockquote>
<p>正0和负0比较起来是相等的，但是还有其他的运算可以区分它们；例如，用1.0除以0.0得到正无穷，但是用1.0除以-0.0得到负无穷。</p>
<p>NaN是无序的（<em>unordered</em>），因此，如果操作数有一个或两个都是NaN，数值比较和数值相等的测试都为<code>false</code>。特别的，数值相等性测试中值与自身的数值相等的结果为<code>false</code>，当且仅当该值为NaN。数值的不等性测试中，如果任何一个操作数是NaN，测试结果为<code>true</code>。</p>
<h3 id="returnaddress类型和值"><a class="header" href="#returnaddress类型和值"><code>returnAddress</code>类型和值</a></h3>
<p><code>returnAddress</code>类型被用于Java虚拟机的<em>jsr</em>、<em>ret</em>和<em>jsr_w</em>指令(<em>§jsr、§ret、§jsr_w</em>)。<code>returnAddress</code>类型的值是指向Java虚拟机指令操作码的指针。不像数字型的原子类型，<code>returnAddress</code>类型没有和Java编程语言的任何类型相对应，而且不能够被正在运行的程序修改。</p>
<h3 id="boolean类型"><a class="header" href="#boolean类型"><code>boolean</code>类型</a></h3>
<p>虽然 Java 虚拟机定义了<code>boolean</code>类型，但提供给其的支持非常有限。 没有单独的 Java 虚拟机指令专用于对布尔值的操作。 相反，Java 编程语言中操作在<code>boolean</code>值上的表达式会被编译成使用Java虚拟机的<code>int</code>数据类型。</p>
<p>Java 虚拟机确实直接支持<code>boolean</code>数组。 它的<code>newarray</code>指令（<em>§newarray</em>）允许创建<code>boolean</code>数组。 <code>boolean</code>类型的数组可以使用<code>byte</code>数组的<em>baload</em>和<em>bastore</em>指令来实现访问和修改（<em>§baload, §bastore</em>）。</p>
<blockquote>
<p>在 Oracle 的 Java 虚拟机实现中，Java编程语言的<code>boolean</code>数组被编码成Java虚拟机的<code>byte</code>数组，每个<code>boolean</code>元素使用8位（8 bits）来表示。</p>
</blockquote>
<p>Java虚拟机对<code>boolean</code>数组进行编码时，使用1表示<code>true</code>，使用0表示<code>false</code>。Java编程语言<code>boolean</code>值被编译器映射到Java虚拟机的<code>int</code>类型的地方，编译器必须使用相同的编码。</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../chap02/data_type.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../chap02/reference_type.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../chap02/data_type.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../chap02/reference_type.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
